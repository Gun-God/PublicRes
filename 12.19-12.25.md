# 阅读《Learning Constraints and Descriptive Segmentation for Subevent Detection》：




### 1. 创新
* 将基于事件的文本分割作为辅助任务，提高子事件检检测(subevent detection, event hierarchy extraction)的性能。
* 为了捕捉两个任务间的依赖关系，使用一个方法(Rectifier Network)自动的学习和执行逻辑依赖。
### 2. 背景知识
子事件的关系有(PARENT-CHILD, CHILDPARENT,COREF, and NOREL),对于一个关系r和一个事件触发词对(ei ,ej)，进行二分类。
基于事件的文本分割致力于找到一个最佳的文本分割，将文档分成几组连续的句子，每个序列都是事件复合体的描述性上下文。对于一个事件触发词进行二分类，表示两个事件是否在事件复合体相同的描述性上下文中。

<br><br>
  ![基于流水线的方法](https://raw.githubusercontent.com/Gun-God/PublicRes/main/img/l1.png)
  <br>


### 3. 方法
<br><br>
  ![基于流水线的方法](https://raw.githubusercontent.com/Gun-God/PublicRes/main/img/l2.png)
  <br>
模型的整体结构如上图，包括约束学习和联合任务学习两个部分

#### 3.1 约束学习
对于上述图中的例子，可以构造一个事件图G包括全部的事件、成员关系、事件文本段信息。下图为G的一个三个事件的子图，约束学习的目标是给定成员关系
和文本段信息判断是否合法
<br><br>
  ![基于流水线的方法](https://raw.githubusercontent.com/Gun-God/PublicRes/main/img/l3.png)
  <br>

扩展Xi,k所有可能的值P(Xi,k)更好地捕捉关系合法性，其中 ![基于流水线的方法](https://raw.githubusercontent.com/Gun-God/PublicRes/main/img/l4.png) 现在三个事件的子图可以表示为

<br><br>
  ![基于流水线的方法](https://raw.githubusercontent.com/Gun-God/PublicRes/main/img/l5.png)
  <br>

对于每个子图，创造一个表示结构合法性的二分类标签t，(X,t)被表示为K线性不等式(K linear inequalities)，如果t=1，表示满足全部的约束的公式如下，K线性不等式等价于Rectifier Network，因此使用Rectifier Network学习约束，p表示t=1的概率，正例是从训练语料库中出现的子图结构中构造，负例是从训练语料库中随机选择的不存在的结构。

<br><br>
  ![基于流水线的方法](https://raw.githubusercontent.com/Gun-God/PublicRes/main/img/l6.png)
  <br>
#### 3.2. 联合任务学习
使用RoBERTa进行编码，对于每个事件对(ei,ej)拼接上下文表示特征和element-wise Hadamard product 和subtraction，然后通过多层的MLP，得到每个关系r的概率，辅助任务文本分割使用另一个MLP判断两个事件是否属于一个文本片段，模型一次处理三次事件，模型图中annotation loss为2个交叉熵loss(一个4分类的子事件监测和一个二分类的文本片段分割)。
总的loss公式如下：

<br><br>
  ![基于流水线的方法](https://raw.githubusercontent.com/Gun-God/PublicRes/main/img/l7.png)
  <br>
推理的时候，对于子事件检测任务，输入一个事件对，根据输出概率判断类型；对于文本分割任务，输入出现在不同句子中的相邻事件(ei,ei+1) ，如果zi ,i+1 = 1，则ei和ej间存在分隔,当两个相邻事件之间存在中间句子时，我们将包含ei的句子视为前一段的结尾。


### 4.  实验
实验数据集为HiEve和Intelligence Community(IC)(均为100篇文章),对于文本分割任务的标注，使用标注的子事件关系为每个文档构造有向无环图，如果一个文档仅一个图，对图进行分割；如果多个图不重叠，则直接标注为上下文；如果重叠，存在一个的事件，其删除导致上下文不重叠，那么假设不考虑该事件来分割上下文。 否则，将上下文合并为一个片段

<br><br>
  ![基于流水线的方法](https://raw.githubusercontent.com/Gun-God/PublicRes/main/img/l8.png)
  <br>

实验结果如下图：

<br><br>
  ![基于流水线的方法](https://raw.githubusercontent.com/Gun-God/PublicRes/main/img/l9.png)
  <br>

消融实验：

<br><br>
  ![基于流水线的方法](https://raw.githubusercontent.com/Gun-God/PublicRes/main/img/l10.png)
  <br>


在辅助任务文本分割上的表现：

<br><br>
  ![基于流水线的方法](https://raw.githubusercontent.com/Gun-God/PublicRes/main/img/l11.png)
  <br>

约束学习的表现：

<br><br>
  ![基于流水线的方法](https://raw.githubusercontent.com/Gun-God/PublicRes/main/img/l12.png)
  <br>